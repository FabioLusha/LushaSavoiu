%Mapping requirements on goals
Beyond the requirements present in the following table, in the goals G4, G7, G8 of the EVD, are also necessary the requirements R1-R2-R6-R32-R33-R34-R35-R36-R26-R28. These requirements regard the possibility to register and log in, and the necessity to interact with the system in a clear way receiving messages about the correct or incorrect operations that take place. For the unregistered EVD we also need the requirements R28-R32-R33-R36, so he can access to some limited functionalities of the system and correctly interact with the software; so we need these requirements in the goals G1-G2-G3-G5-G6, that are the only ones that can be achieved not only by the registered EVD, but by any EVD. The requirement R34 is also present for the registered and unregistered EVD in the goals G1-G2-G3. \\\\
With regards to the CPO, as for the EVD, to  not clutter the table we will not indicate the requirements that are needed for all the operations. In particular the requirements concerning the login (R27) which by assumption D9 is done with company credentials, and the ones allowing the CPO to interact with the system in a more systematically way checking the correctness of the data (R51), get notification of operation success or error (R53, R54) and saving the in a persistent why the parameters of the charging stations that the CPO modifies (R52).
\begin{center}
    \begin{longtable}[H]{|p{0.1\linewidth}|p{0.3\linewidth}|p{0.5\linewidth}|}
     \hline
     \textbf{Goal} & \textbf{Domain assumptions} & \textbf{Requirements}\\
     \hline
     %The EVD is able to identify the charging stations nearby
     G1 & D1, D2, D3, D4, D6 
        & R8, R9, R10, R11, R12, R14, R16, R31\\
     \hline
     %The EVD is able to visualize the tariffs of the charging stations
     G2 & D1, D2, D3, D4, D6  
        & R8, R9, R10, R11, R12, R14, R15, R16, R31\\
     \hline
     %The EVD is able to visualize any special offer available at the charging station
     G3 & D1, D2, D3, D4, D6 
        & R8, R9, R10, R11, R12, R14, R15, R16, R31\\
     \hline
     %The EVD is able to book a charge in a specific charging station for a certain time frame
     G4 & D1, D2, D3, D4, D6, D8 
        & R17, R18, R31, R37, R38, R39 \\
     \hline
     %The EVD is able to start the charging process at a certain station
     G5 & D1, D2, D3, D4, D6 
        & R23, R24, R40, R41, R67\\
     \hline
     %The EVD is able to pay for the obtained service
     G6 & D1, D2, D3, D4, D7 
        & R25, R68\\
     \hline
     %The EVD can manage his bookings and charging sessions
     G7 & D1, D2, D3, D4, D8
        & R13, R19, R21, R22, R29, R63\\
     \hline
     %The EVD can manage and modify his account details (personal data and EVs information
     G8 & D1, D2, D3, D4, D8
        & R3, R4, R5, R7, R20\\
     \hline
     %The CPO can decide from which DSO to acquire energy
     G9 & D5, D6, D9, D10
        & R30, R42, R44, R55, R56, R57, R58, R59\\
     \hline
     %The CPO can decide the cost of charging
     G10 & D5, D6, D9, D13
        & R42, R44, R49, R55\\
     \hline
     %The CPO can set special offers
     G11 & D5, D6, D9, D11, D12, D13
        & R42, R44, R49, R50, R55, R60\\
     \hline
     %The CPO can decide whether to store or not energy in batteries
      G12 & D5, D6, D9
        & R42, R44, R55, R65\\
     \hline
     %The CPO can decide whether to use the energy available in the batteries
      G13 & D5, D6, D9
        & R42, R44, R55, R66\\
     \hline
     %The CPO can manage the charging stations' daily operations
     G14 & D5, D6, D9, D11, D12, D13
        & R42, R43, R44, R45, R46, F47, R48, R49, R50, R55, R56, R57, R58, R59, R60, R61, R62, R64, R65, R66 \\
     \hline
    \caption{Mapping on goals}
    \label{tab:Mapping on goals}
    \end{longtable}
\end{center}

\subsection{Explanation of the mapping on goals regarding the EVD}
In order to achieve the following goals the EVD has to create an account. So we report here what are the requirements of the system in order for the EVD to register and then to log in the system with the account:
\begin{itemize}
    \item R1: The system shall allow an unregistered EVD to register an account
    \item R2: The system shall allow a registered EVD to insert data about his EVs
    \item R6: The system shall allow a registered EVD to insert personal data (name, surname, email, payment details)
    \item R32: The system must notify the EVD with a specific message, that clarifies the problem, if an error occurs (login error, update error, payment error, ecc.)
    \item R33: The system must notify the EVD with a success message if the operation terminated without errors (successful registration, successful profile modification, ecc.)
    \item R34: The system must ask for EVD's consent to use the location information given by the GPS module
    \item R35: The system must ask the EVD, during registration, to agree to the terms of service
    \item R36: The system must check for the correctness of the data inserted by the EVD (login details, charging point code, ecc.)
    \item R26: The system must allow the registered EVD to log in
    \item R28: The system must allow the EVD to access the mobile application, eMma, with or without an account
\end{itemize}
We can notice that the system shall allow an EVD to register and for the registration is also important to be able to insert the personal details and the EVs details, which then can be managed by the application. The registration also requires to accept the terms of service and sharing personal data such as the GPS location. After completing the registration, the system has to log in the EVD that uses the mail and the password chosen during registration. It is also important to specify that the EVD can also interact with the system without an account (R28), but in that case he has a limited interaction, because he can only visualize the charging stations on the map, with the respective details, and charge the vehicle, paying also an initial deposit to start the charging, but he cannot access all the functionalities of the system, such as the possibility to book a charge.\\\\
In the requirements reported in this initial steps we also notice the fact that the system always sends a message to notify the success or the failure of an operation, giving also some details about the occurred error. These two requirements (R32, R33) are present in all the goals, because the system always has to inform the users of the operation's outcome. Also the system has to check the correctness of all the data inserted by the EVD (R36), so this is necessary in all the goals that require the insertion of data.\\\\
Now we will report all the EVD's goals with the related requirements, implying that the ones just explained are required in some of the goals, as already mentioned in the previous section.

\paragraph{G1: The EVD is able to identify the charging stations nearby}
\begin{itemize}
    \item R8: The system shall allow an EVD to view the charging stations on the map
    \item R16: The system by default must show on the homepage the charging stations on the map territory, centered on the EVD's location
    \item R9: The system shall allow an EVD to view relevant data about the charging stations
    \item R10: The system shall allow an EVD to view relevant data about a specific charging point
    \item R11: The system shall allow an EVD to view the prices of the charging points of the stations
    \item R12: The system shall allow an EVD to view the special offers of the charging points of the stations
    \item R14: The system shall allow an EVD to share his location through the GPS module of his mobile phone
    \item R31: The system must collect the data about the charging stations from the CPOs
\end{itemize}
For the EVD to be able to choose a charging station for his EV the system must present a visualization of the available charging stations near his geolocation (R8, R14, R16). To offer this functionality the system must collect information about charging stations provided by their CPO (R31). To be useful for the EVD the system must show a variety of information regarding the charging stations, in particular the tariffs and the socket type of the charging points (R9, R10, R11, R12).

\paragraph{G2: The EVD is able to visualize the tariffs of the charging stations}
\begin{itemize}
     \item R8: The system shall allow an EVD to view the charging stations on the map
    \item R9: The system shall allow an EVD to view relevant data about the charging stations
    \item R10: The system shall allow an EVD to view relevant data about a specific charging point
    \item R11: The system shall allow an EVD to view the prices of the charging points of the stations
    \item R12: The system shall allow an EVD to view the special offers of the charging points of the stations
    \item R14: The system shall allow an EVD to share his location through the GPS module of his mobile phone
    \item R15: The system shall allow an EVD to choose the area in which to visualize the charging stations on the map, if different from the actual GPS location
    \item R16: The system by default must show on the homepage the charging stations on the map territory, centered on the EVD's location
    \item R31: The system must collect the data about the charging stations from the CPOs
\end{itemize}
To achieve this goal, the system must be able to provide the user with a view containing all the relevant information of a charging station (R8, R9, R10, R11, R12). To be able to show this information the system must collect them from the respective owners of the charging stations (R31). Finally this information must be provided based on the user needs (R14, R15, R16).

\paragraph{G3: The EVD is able to visualize any special offer available at the charging station}
\begin{itemize}
    \item R8: The system shall allow an EVD to view the charging stations on the map
    \item R9: The system shall allow an EVD to view relevant data about the charging stations
    \item R10: The system shall allow an EVD to view relevant data about a specific charging point
    \item R11: The system shall allow an EVD to view the prices of the charging points of the stations
    \item R12: The system shall allow an EVD to view the special offers of the charging points of the stations
    \item R14: The system shall allow an EVD to share his location through the GPS module of his mobile phone
    \item R15: The system shall allow an EVD to choose the area in which to visualize the charging stations on the map, if different from the actual GPS location
    \item R16: The system by default must show on the homepage the charging stations on the map territory, centered on the EVD's location
    \item R31: The system must collect the data about the charging stations from the CPOs
\end{itemize}
We can notice that to satisfy the first three goals we need almost the same requirements, because is necessary to identify the charging stations nearby, and also other stations in the searched locations, in order to visualize the price and the special offers available at the charging stations.\\\\
The requirements R8-R9-R10-R11-R12-R14-R15-R16-R31 shown in the previous goals are also necessary for the next one.

\paragraph{G4: The EVD is able to book a charge in a specific charging station for a certain time frame}
To achieve this goal, as already said, are necessary all the requirements that appear in (G1, G2, G3) because before the booking of the charge is first necessary to be able to visualize the charging stations and their respective information.\\
After the visualization we have that the following requirements are the mainly ones necessary to really achieve this goal:
\begin{itemize}
    \item R37: The system must show only the free charging points to book
    \item R38: The system must show for each available charging point the relevant information (type of charging, type of socket, charging speed, price, special offers, etc.)
    \item R17: The system shall allow a registered EVD to book a charge from an available charging point in a charging station
    \item R18: The system shall allow a registered EVD to choose the time-frame (date and time) in which to book a charge
    \item R39: The system must show a summary of the successful booking operation
\end{itemize}

\paragraph{G5: The EVD is able to start the charging process at a certain station}
\begin{itemize}
    \item R23: The system shall allow an EVD to start a charging session
    \item R24: The system shall allow a registered EVD to insert the charging point code, in order to start a charging session
    \item R41: The system must unlock the charging point if the code is correct
    \item R40: The system must change the status of the charging point during charging
    \item R67: The system shall allow an EVD to charge the battery until full capacity
\end{itemize}
Goal G5 imposes the system to allow all the user that can access the service through eMma to start a charging session by inserting the code shown on the charging point by the eMci terminal (23, 24). If the code is correct the system must unlock the charging point for the user (R41) allowing him to continue charging until the battery is fully charged (R67). Moreover the system must update the status of the charging point from free to occupied (R40).

\clearpage
\paragraph{G6: The EVD is able to pay for the obtained service}
\begin{itemize}
    \item R25: The system shall allow an EVD to choose the payment method to use in order to pay for the obtained service
    \item R68: The system must communicate with external APIs to complete the payment
\end{itemize}
Given the abundance of different payment systems, the eMall must be able to allow the users to choose their preferred method payment (R25) which enforces the usage of the external API, made available by the providers of these kind of services (R68).
\paragraph{G7: The EVD can manage his bookings and charging sessions}
\begin{itemize}
    \item R19: The system shall allow a registered EVD to cancel a charging point booking
    \item R29: The system must store the charging history: previous charges and bookings related to the specific EV
    \item R21: The system shall allow a registered EVD to view the charging history 
    \item R22: The system shall allow a registered EVD to choose a visualization criteria for the charging history
    \item R63: The system shall allow the registered EVD to view his upcoming bookings
    \item R13: The system shall allow a registered EVD to review a charging station 
\end{itemize}
To achieve this goal the EVD must be able to view and cancel a previously booked charging session (R63, R19). Moreover the EVD must be able to view his past charging sessions (R29, R21, R22) and, if he wants, leave a review of the charging stations he has visited (R13).

\paragraph{G8: The EVD can manage and modify his account details (personal data and EVs information)}
\begin{itemize}
    \item R3: The system shall allow a registered EVD to update EV's details
    \item R4: The system shall allow a registered EVD to add new EVs
    \item R5: The system shall allow a registered EVD to delete an EV
    \item R7: The system shall allow a registered EVD to update personal data
    \item R20: The system shall allow a registered EVD to visualize his profile data
\end{itemize}
The last two goals allow the user to manage his account and retrieve some information about how the service is used. We can notice that G7-G8 and G4 are goals related only to the registered EVD, which can take advantage of all the functionalities of the system and have a better experience of the service.

\subsection{Explanation of the mapping on goals regarding the CPO}
As per the introduction in \ref{sec: Mapping on goals} requirements R27, R51, R52, R53 and R54 are always present for the reasons explained in that section, thus in the following explanations it will be omitted for brevity. We also point out that also the requirements R42, R44, and R55 are always present. These requirements are needed because to execute any action on the system the CPO needs first to select the charging station in which he wants to execute his action. This objective is realized through the requirements R42 and R55:
\begin{itemize}
    \item R42: The system shall allow the CPO to view the charging stations
    \item R55: The system shall allow the CPO to select a charging station
\end{itemize}
Moreover we assumed that the CPO executes his operations on an already set-up system, so every operation he makes on a station results in an update of the station details, so the requirement R44 is also always present. Having explained this requirements here, they will not be explained any further in the following parts.
\paragraph{G9: The CPO can decide from which DSO to acquire energy}
\begin{itemize}
    \item R30: The system must collect electric energy data from the DSOs
    \item R42: The system shall allow the CPO to view the charging stations
    \item R55: The system shall allow the CPO to select a charging station
    \item R44: The system shall allow the CPO to update the details of a charging station
    \item R56: The system shall allow the CPO to view the DSO's updated prices for the energy sources
    \item R57: The system shall allow the CPO to view the DSO's special offers for the energy sources
    \item R58: The system shall allow the CPO to change the DSO of a charging station
    \item R59: The system shall allow the CPO to choose the DSO's energy source for the charging station
\end{itemize}
In order to achieve this goal the CPO must be able to compare the tariffs offered by different DSO (R30, R56, R57). Moreover, the CPO shall be able to select the DSO, from which energy source the electricity provided will be generated (R59). Finally the CPO is able to confirm his choice so it has an effect on the system (R58).
\paragraph{G10: The CPO can decide the cost of charging}
\begin{itemize}
    \item R42: The system shall allow the CPO to view the charging stations
    \item R55: The system shall allow the CPO to select a charging station
    \item R44: The system shall allow the CPO to update the details of a charging station
    \item R49: The system shall allow the CPO to set the price of the charging point
\end{itemize}
In order to set the price of a charging point the CPO must be able to select the desired charging station (R42, R55) and set the price for a particular charging point (R44, R49).

\paragraph{G11: The CPO can set special offers}
\begin{itemize}
    \item R42: The system shall allow the CPO to view the charging stations
    \item R55: The system shall allow the CPO to select a charging station
    \item R44: The system shall allow the CPO to update the details of a charging station
    \item R49: The system shall allow the CPO to set the price of the charging point
    \item R50: The system shall allow the CPO to set a special offer for the charging point
    \item R60: The system shall allow the CPO to set a special offer for the charging station
\end{itemize}
The CPO can set a special offer for an entire station or a particular charging point by inserting the promotion details (R50, R60) and, then, the system must update the prices as per the CPO instructions (R44, R49).

\paragraph{G12: The CPO can decide whether to store or not energy in batteries}
\begin{itemize}
    \item R42: The system shall allow the CPO to view the charging stations
    \item R55: The system shall allow the CPO to select a charging station
    \item R44: The system shall allow the CPO to update the details of a charging station  
    \item R65: The system shall allow the CPO to decide if for a charging station wants to store energy from the DSO in the battery of the station
\end{itemize}
To achieve this goal the user has only to select the charging station in which he wants to use the battery as an energy source (R42, R55) and then confirm his choice (R44, R65).

\paragraph{G13: The CPO can decide whether to use the energy available in the batteries}
\begin{itemize}
    \item R42: The system shall allow the CPO to view the charging stations
    \item R55: The system shall allow the CPO to select a charging station
    \item R44: The system shall allow the CPO to update the details of a charging station
    \item R66: The system shall allow the CPO to decide if for a charging station wants to use the battery or acquire energy from the DSO
\end{itemize}
To achieve this goal the user has only to select the charging station in which he wants to recharge the battery (R42, R55) and then confirm his choice (R44, R66).

\paragraph{G14: The CPO can manage the charging stations' daily operations}
To manage the charging stations daily operations the CPO needs all the requirements cited before, because all the other goals contain operations needed in the daily management of the service. Beyond the already mentioned requirements, additional ones are needed to allow the CPO to perform actions that are necessary to manage the system and the events that may occur on daily basis. In particular we considered the following requirements:
\begin{itemize}
     \item R45: The system shall allow the CPO to delete a charging station
     \item R46: The system shall allow the CPO to add a charging station
     \item R47: The system shall allow the CPO to delete a charging point from a charging station
     \item R48: The system shall allow the CPO to add a charging point to a charging station
     \item R61: The system shall allow the CPO to select some criteria to graphically visualize aspects of the charging stations
     \item R62: The system must show a graphical representation of some aspects of the charging stations
     \item R43: The system shall allow the CPO to view any notification regarding the charging stations
     \item R64: The system shall allow the CPO to select a notification to solve it
\end{itemize}
Events that can occur during the natural operation of an EV charging facility business may include the addition or removal of charging points (R47, R48) and the opening of a new charging station (R46) or closing or selling of a previous managed charging station (R46). Moreover the CPO must be able to handle any unexpected event that may happen in a charging station (like charging points fault, maintenance, etc) (R43, R64). Finally the user shall have a way to visualize some graphical data of how business is doing (R61, R62), in order to have the opportunity to improve the service and the earnings of the company, based on an analysis of the provided graphical information.